(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[430],{7623:function(e,t,a){Promise.resolve().then(a.bind(a,1837))},1837:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var r=a(7437),n=a(2265),i=a(5805);let s=(0,a(9763).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var d=a(9474),c=a(5302),o=a(2869),l=a(8079),m=a(5978),p=a(4257);let u="tournaments",x="tournamentParticipants",h={getTournaments:async e=>{let t;let a=await (0,p.xI)();if(!a)return[];let r=(0,m.hJ)(a,u);return t=e?(0,m.IO)(r,(0,m.ar)("status","==",e),(0,m.Xo)("startTime","asc")):(0,m.IO)(r,(0,m.Xo)("startTime","asc")),(await (0,m.PL)(t)).docs.map(e=>{var t,a;return{id:e.id,name:e.data().name,game:e.data().game,description:e.data().description,participants:e.data().participants||0,maxParticipants:e.data().maxParticipants,startTime:(null===(t=e.data().startTime)||void 0===t?void 0:t.toDate())||new Date,endTime:null===(a=e.data().endTime)||void 0===a?void 0:a.toDate(),prize:e.data().prize,status:e.data().status,createdBy:e.data().createdBy,winner:e.data().winner}})},getUpcomingTournaments:async()=>{let e=await (0,p.xI)();if(!e)return[];let t=(0,m.hJ)(e,u),a=m.EK.now(),r=(0,m.IO)(t,(0,m.ar)("startTime",">",a),(0,m.ar)("status","==","upcoming"),(0,m.Xo)("startTime","asc"));return(await (0,m.PL)(r)).docs.map(e=>{var t,a;return{id:e.id,name:e.data().name,game:e.data().game,description:e.data().description,participants:e.data().participants||0,maxParticipants:e.data().maxParticipants,startTime:(null===(t=e.data().startTime)||void 0===t?void 0:t.toDate())||new Date,endTime:null===(a=e.data().endTime)||void 0===a?void 0:a.toDate(),prize:e.data().prize,status:e.data().status,createdBy:e.data().createdBy,winner:e.data().winner}})},getActiveTournaments:async()=>h.getTournaments("active"),getEndedTournaments:async()=>h.getTournaments("ended"),getTournament:async e=>{var t,a;let r=await (0,p.xI)();if(!r)return null;let n=(0,m.JU)(r,u,e),i=await (0,m.QT)(n);if(!i.exists())return null;let s=i.data();return{id:i.id,name:s.name,game:s.game,description:s.description,participants:s.participants||0,maxParticipants:s.maxParticipants,startTime:(null===(t=s.startTime)||void 0===t?void 0:t.toDate())||new Date,endTime:null===(a=s.endTime)||void 0===a?void 0:a.toDate(),prize:s.prize,status:s.status,createdBy:s.createdBy,winner:s.winner}},createTournament:async(e,t)=>{let a=await (0,p.xI)();if(!a)return null;let r=(0,m.hJ)(a,u),n=(0,m.JU)(r);return await (0,m.pl)(n,{...t,participants:0,status:"upcoming",createdBy:e,createdAt:(0,m.Bt)()}),n.id},joinTournament:async(e,t,a,r)=>{let n=await (0,p.xI)();if(!n)return!1;let i=await h.getTournament(t);if(!i||i.participants>=i.maxParticipants)return!1;let s=(0,m.JU)(n,x,"".concat(t,"_").concat(e));if((await (0,m.QT)(s)).exists())return!1;await (0,m.pl)(s,{userId:e,tournamentId:t,displayName:a,photoURL:r,score:0,joinedAt:(0,m.Bt)()});let d=(0,m.JU)(n,u,t);return await (0,m.r7)(d,{participants:(i.participants||0)+1}),!0},getParticipants:async e=>{let t=await (0,p.xI)();if(!t)return[];let a=(0,m.hJ)(t,x),r=(0,m.IO)(a,(0,m.ar)("tournamentId","==",e));return(await (0,m.PL)(r)).docs.map(e=>{var t;return{userId:e.data().userId,displayName:e.data().displayName,photoURL:e.data().photoURL,score:e.data().score||0,joinedAt:(null===(t=e.data().joinedAt)||void 0===t?void 0:t.toDate())||new Date}}).sort((e,t)=>t.score-e.score)},isParticipant:async(e,t)=>{let a=await (0,p.xI)();if(!a)return!1;let r=(0,m.JU)(a,x,"".concat(t,"_").concat(e));return(await (0,m.QT)(r)).exists()},updateScore:async(e,t,a)=>{let r=await (0,p.xI)();if(!r)return;let n=(0,m.JU)(r,x,"".concat(t,"_").concat(e));await (0,m.r7)(n,{score:a,updatedAt:(0,m.Bt)()})}};var g=a(4508);function f(){let{user:e}=(0,l.a)(),[t,a]=(0,n.useState)("upcoming"),[m,p]=(0,n.useState)([]),[u,x]=(0,n.useState)(new Set),[f,v]=(0,n.useState)(!0),[y,w]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{v(!0);try{let a=[];switch(t){case"upcoming":a=await h.getUpcomingTournaments();break;case"active":a=await h.getActiveTournaments();break;case"ended":a=await h.getEndedTournaments()}if(p(a),e){let t=new Set;for(let r of a)await h.isParticipant(e.id,r.id)&&t.add(r.id);x(t)}}catch(e){}finally{v(!1)}})()},[t,e]);let b=async t=>{if(e){w(t.id);try{var a;await h.joinTournament(e.id,t.id,e.displayName||"Anonymous",(null===(a=e.avatar)||void 0===a?void 0:a.startsWith("http"))?e.avatar:void 0)&&(x(e=>new Set(Array.from(e).concat(t.id))),p(e=>e.map(e=>e.id===t.id?{...e,participants:e.participants+1}:e)))}catch(e){}finally{w(null)}}},j=e=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e);return f?(0,r.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,r.jsx)("h1",{className:"font-display text-2xl font-bold uppercase tracking-wider text-primary",children:"Tournaments"}),(0,r.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"Loading tournaments..."})]}):(0,r.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"font-display text-2xl font-bold uppercase tracking-wider text-primary mb-2",children:"Tournaments"}),(0,r.jsx)("p",{className:"text-muted-foreground text-sm",children:e?"Compete in tournaments for big prizes":"Sign in to join tournaments"})]}),(0,r.jsx)(o.z,{disabled:!e,children:"Create Tournament"})]}),(0,r.jsx)("div",{className:"flex gap-2",children:[{id:"upcoming",label:"Upcoming"},{id:"active",label:"Active"},{id:"ended",label:"Past"}].map(e=>(0,r.jsx)("button",{onClick:()=>a(e.id),className:(0,g.cn)("px-4 py-2 text-xs font-medium uppercase tracking-wider transition-colors",t===e.id?"bg-elevated border border-accent-border text-accent":"bg-transparent border border-transparent text-muted-foreground hover:text-primary"),children:e.label},e.id))}),(0,r.jsx)("div",{className:"space-y-4",children:m.length>0?m.map(t=>{let a=u.has(t.id),n=t.participants>=t.maxParticipants;return(0,r.jsx)("div",{className:"bg-elevated border border-white/[0.06] p-4 hover:border-white/[0.12] transition-colors",children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h3",{className:"font-display text-lg font-bold uppercase tracking-wide text-primary",children:t.name}),(0,r.jsx)("p",{className:"text-sm text-accent",children:t.game}),t.description&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:t.description}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-xs text-muted-foreground flex-wrap",children:[(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)(i.Z,{className:"w-3 h-3"}),t.participants,"/",t.maxParticipants," players"]}),(0,r.jsxs)("span",{className:"flex items-center gap-1",children:[(0,r.jsx)(s,{className:"w-3 h-3"}),j(t.startTime)]}),"ended"===t.status&&t.winner&&(0,r.jsxs)("span",{className:"flex items-center gap-1 text-success",children:[(0,r.jsx)(d.Z,{className:"w-3 h-3"}),"Winner: ",t.winner]})]})]}),(0,r.jsxs)("div",{className:"text-right flex-shrink-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-warning justify-end",children:[(0,r.jsx)(d.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"font-mono font-bold",children:t.prize})]}),(0,r.jsx)("p",{className:"text-[10px] text-muted-foreground",children:"coins"}),"upcoming"===t.status&&(a?(0,r.jsxs)("div",{className:"flex items-center gap-1 text-success text-xs mt-2 justify-end",children:[(0,r.jsx)(c.Z,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:"Joined"})]}):(0,r.jsx)(o.z,{size:"sm",className:"mt-2",disabled:!e||n||y===t.id,onClick:()=>b(t),children:y===t.id?"...":n?"Full":"Join"})),"active"===t.status&&(0,r.jsx)(o.z,{size:"sm",className:"mt-2",variant:"primary",children:"Play"}),"ended"===t.status&&(0,r.jsx)("span",{className:"text-xs text-muted-foreground mt-2 block",children:"Ended"})]})]})},t.id)}):(0,r.jsxs)("div",{className:"bg-elevated border border-white/[0.06] p-12 text-center",children:[(0,r.jsx)(d.Z,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),(0,r.jsxs)("h3",{className:"font-display text-lg font-bold text-primary mb-2",children:["No ",t," Tournaments"]}),(0,r.jsx)("p",{className:"text-muted-foreground text-sm mb-4",children:"upcoming"===t?"Create a tournament to play with friends":"active"===t?"No tournaments are currently active":"No past tournaments to display"}),"upcoming"===t&&(0,r.jsx)(o.z,{disabled:!e,children:"Create Tournament"})]})})]})}},2869:function(e,t,a){"use strict";a.d(t,{z:function(){return s}});var r=a(7437),n=a(2265),i=a(4508);let s=n.forwardRef((e,t)=>{let{className:a,variant:n="default",size:s="default",isLoading:d=!1,children:c,...o}=e;return(0,r.jsx)("button",{className:(0,i.cn)("inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium uppercase tracking-wider transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-accent disabled:pointer-events-none disabled:opacity-50",{default:"bg-accent-dim border border-accent-border text-accent hover:bg-accent/20 hover:border-accent",primary:"bg-accent text-background hover:bg-accent/90 border border-accent",secondary:"bg-elevated border border-white/[0.08] text-primary hover:bg-raised hover:border-white/[0.12]",ghost:"hover:bg-elevated hover:text-primary text-muted-foreground",danger:"bg-danger/10 border border-danger/30 text-danger hover:bg-danger/20 hover:border-danger/50",outline:"border border-white/[0.08] bg-transparent hover:bg-elevated hover:text-primary"}[n],{default:"h-9 px-4 py-2",sm:"h-8 px-3 text-xs",lg:"h-11 px-8 text-base",icon:"h-9 w-9"}[s],d&&"opacity-70 cursor-wait",a),ref:t,disabled:o.disabled||d,...o,children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):c})});s.displayName="Button"},5302:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9474:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])},5805:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},function(e){e.O(0,[358,533,24,30,971,117,744],function(){return e(e.s=7623)}),_N_E=e.O()}]);